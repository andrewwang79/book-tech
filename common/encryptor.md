# 加密机
* 用于金融加解密

## 秘钥
| 类型 | 加密 | 密钥输入方式 |
| :-: | - | - |
| 公钥 | 明文 | index |
| 私钥 | 密文 | 明文内容 |
| 对称密钥 | 密文 | 明文内容 |

## 说明
* 32H时1A是X，48H时1A是Y
* LMK是100个存储密钥（32位）的空间，2个空间一组密钥。index有约定俗成的用法，但不限制使用。
* RSA存放在一个21个存储密钥（32位）的空间，只存私钥。所有私钥通过LMK的一组密钥加密。
* key生成：
  * 加密机上直接操作：输入明文key，生成密文key。
  * RSA钥匙是自动生成。

## 命令
| 操作 | 命令 | 密钥输入方式 | 密钥类型(建议) | 说明 |
| :-: | - | - | - | - |
| DES加解密 | E0 | 密文 | zek | 灌密钥 |
| 3DES加解密 | E0 | 密文 | zek | 灌密钥 |
| 公钥加密(RSA) | 30 | 索引 | 17 |  |
| 私钥加密(RSA) | 3D | 索引 | 17 |  |
| 验签(RSA) | 38 | 公钥明文 | 外部公钥 |  |
| 生成PIN | BA，JG | 密文 | zpk | 帐号，密码，pinKey（目的zpk）。灌密钥。加密机没有授权 ，串口连接加密机输入acy。 |
| 生成MAC | MU | 密文 | zak | 参考（MS），参数一样。灌密钥 |

资料：
* [金融行业密钥详解](http://bbs.chinaunix.net/thread-1572937-1-1.html)
